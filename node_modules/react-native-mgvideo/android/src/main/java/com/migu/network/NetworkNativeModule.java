package com.migu.network;

import com.facebook.react.bridge.NativeModule;
import com.facebook.react.bridge.ReactApplicationContext;
import com.facebook.react.bridge.ReactContext;
import com.facebook.react.bridge.ReactContextBaseJavaModule;
import com.facebook.react.bridge.ReactMethod;
import com.facebook.react.common.MapBuilder;
import com.facebook.react.bridge.UiThreadUtil;
import com.facebook.react.bridge.Callback;
import android.util.Log;
import android.content.Context;
import android.net.NetworkInfo;
import android.net.ConnectivityManager;

public class NetworkNativeModule extends ReactContextBaseJavaModule {
    public static final String TAG = "ReactNativeJS";
    public static final String REACT_CLASS = "NetworkModule";

    public NetworkNativeModule(ReactApplicationContext context) {
        super(context);
    }

    @Override
    public String getName() {
        return REACT_CLASS;
    }
    //public static final int TYPE_MOBILE      = 0;
    //public static final int TYPE_WIFI        = 1;
    @ReactMethod
    public void getNetworkType(Callback callback) {
        ReactApplicationContext context = getReactApplicationContext();
        ConnectivityManager connectMgr = (ConnectivityManager)
                    context.getSystemService(Context.CONNECTIVITY_SERVICE);
        NetworkInfo info = connectMgr.getActiveNetworkInfo();
        int networkType = -1;
        if (info != null) {
            if (info.getType() == ConnectivityManager.TYPE_WIFI) {
                networkType = 1;
            } else if (info.getType() ==  ConnectivityManager.TYPE_MOBILE) {
                networkType = info.getSubtype();
            }
        }
        if (callback != null) {
            callback.invoke(networkType);
        }
    }
}